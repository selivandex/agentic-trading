# @format

# Agent types and operations

type Agent {
  id: Int!
  identifier: String!
  name: String!
  description: String!
  category: String!

  # Prompts
  systemPrompt: String!
  instructions: String!

  # Model configuration
  modelProvider: String!
  modelName: String!
  temperature: Float!
  maxTokens: Int!

  # Tools
  availableTools: [String!]!

  # Limits
  maxCostPerRun: Float!
  timeoutSeconds: Int!

  # Status
  isActive: Boolean!
  version: Int!

  # Timestamps
  createdAt: Time!
  updatedAt: Time!
}

"""
Edge type for Agent
"""
type AgentEdge {
  """
  The item at the end of the edge
  """
  node: Agent!

  """
  A cursor for use in pagination
  """
  cursor: String!
}

"""
Connection type for Agent collection
"""
type AgentConnection {
  """
  A list of edges
  """
  edges: [AgentEdge!]!

  """
  Information to aid in pagination
  """
  pageInfo: PageInfo!

  """
  Total count of items (if available)
  """
  totalCount: Int!
}

input CreateAgentInput {
  identifier: String!
  name: String!
  description: String!
  category: String!
  systemPrompt: String!
  instructions: String
  modelProvider: String!
  modelName: String!
  temperature: Float
  maxTokens: Int
  availableTools: [String!]
  maxCostPerRun: Float
  timeoutSeconds: Int
  isActive: Boolean
}

input UpdateAgentInput {
  name: String
  description: String
  category: String
  systemPrompt: String
  instructions: String
  modelProvider: String
  modelName: String
  temperature: Float
  maxTokens: Int
  availableTools: [String!]
  maxCostPerRun: Float
  timeoutSeconds: Int
}

# Queries
extend type Query {
  # Get agent by ID
  agent(id: Int!): Agent

  # Get agent by identifier
  agentByIdentifier(identifier: String!): Agent

  # Get all agents
  agents(
    category: String
    isActive: Boolean
    first: Int
    after: String
    last: Int
    before: String
  ): AgentConnection!
}

# Mutations
extend type Mutation {
  # Create new agent (admin only)
  createAgent(input: CreateAgentInput!): Agent!

  # Update agent configuration (admin only)
  updateAgent(id: Int!, input: UpdateAgentInput!): Agent!

  # Delete agent (admin only)
  deleteAgent(id: Int!): Boolean!

  # Batch delete agents (admin only)
  batchDeleteAgents(ids: [Int!]!): Int!

  # Activate/deactivate agent
  setAgentActive(id: Int!, isActive: Boolean!): Agent!

  # Update agent prompt (for tuning)
  updateAgentPrompt(id: Int!, systemPrompt: String!): Agent!

  # Ensure all system agents exist (FindOrCreate pattern)
  ensureSystemAgents: Boolean!
}
