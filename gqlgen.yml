# @format

# gqlgen configuration file
# Schema-first approach: GraphQL schema -> Go code
# See: https://gqlgen.com/config/

# Schema files to generate from
schema:
  - internal/api/graphql/schema/*.graphql

# Where the generated server code will be saved
exec:
  filename: internal/api/graphql/generated/generated.go
  package: generated
  layout: single-file

# Where the generated models will be saved
model:
  filename: internal/api/graphql/generated/models.go
  package: generated

# Where the resolver implementations will be scaffolded
resolver:
  layout: follow-schema
  dir: internal/api/graphql/resolvers
  package: resolvers
  filename_template: "{name}.resolvers.go"

# Autobind only works when types match exactly
autobind:
  - prometheus/internal/domain/user
  - prometheus/internal/domain/strategy
  - prometheus/internal/domain/fundwatchlist

# Model mappings - map GraphQL types to Go types
models:
  # Custom scalars with marshal/unmarshal functions
  UUID:
    model:
      - github.com/google/uuid.UUID

  Decimal:
    model:
      - github.com/shopspring/decimal.Decimal

  Time:
    model:
      - time.Time

  JSONObject:
    model:
      - map[string]interface{}

  # Map domain entities (these will bind if fields match)
  User:
    model:
      - prometheus/internal/domain/user.User
    fields:
      telegramID:
        resolver: true # Force resolver since field name differs (TelegramID vs telegramID)
      telegramUsername:
        resolver: true
      firstName:
        resolver: true
      lastName:
        resolver: true
      languageCode:
        resolver: true
      isActive:
        resolver: true
      isPremium:
        resolver: true
      limitProfileID:
        resolver: true

  Strategy:
    model:
      - prometheus/internal/domain/strategy.Strategy
    fields:
      userID:
        resolver: true
      user:
        resolver: true

  FundWatchlist:
    model:
      - prometheus/internal/domain/fundwatchlist.Watchlist
    fields:
      marketType:
        resolver: true

  Settings:
    model:
      - prometheus/internal/domain/user.Settings

  # Enums from domain
  StrategyStatus:
    model:
      - prometheus/internal/domain/strategy.StrategyStatus
  MarketType:
    model:
      - prometheus/internal/domain/strategy.MarketType
  RiskTolerance:
    model:
      - prometheus/internal/domain/strategy.RiskTolerance
  RebalanceFrequency:
    model:
      - prometheus/internal/domain/strategy.RebalanceFrequency

# Don't run go mod tidy automatically
skip_mod_tidy: true

# Don't skip validation
skip_validation: false
